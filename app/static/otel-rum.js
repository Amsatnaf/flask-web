(()=>{var Me=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{};var x="1.9.0";var Ce=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function En(t){var e=new Set([t]),r=new Set,n=t.match(Ce);if(!n)return function(){return!1};var o={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(o.prerelease!=null)return function(c){return c===t};function s(a){return r.add(a),!1}function i(a){return e.add(a),!0}return function(c){if(e.has(c))return!0;if(r.has(c))return!1;var p=c.match(Ce);if(!p)return s(c);var E={major:+p[1],minor:+p[2],patch:+p[3],prerelease:p[4]};return E.prerelease!=null||o.major!==E.major?s(c):o.major===0?o.minor===E.minor&&o.patch<=E.patch?i(c):s(c):o.minor<=E.minor?i(c):s(c)}}var Ie=En(x);var un=x.split(".")[0],$=Symbol.for("opentelemetry.js.api."+un),X=Me;function C(t,e,r,n){var o;n===void 0&&(n=!1);var s=X[$]=(o=X[$])!==null&&o!==void 0?o:{version:x};if(!n&&s[t]){var i=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+t);return r.error(i.stack||i.message),!1}if(s.version!==x){var i=new Error("@opentelemetry/api: Registration of version v"+s.version+" for "+t+" does not match previously registered API v"+x);return r.error(i.stack||i.message),!1}return s[t]=e,r.debug("@opentelemetry/api: Registered a global for "+t+" v"+x+"."),!0}function d(t){var e,r,n=(e=X[$])===null||e===void 0?void 0:e.version;if(!(!n||!Ie(n)))return(r=X[$])===null||r===void 0?void 0:r[t]}function I(t,e){e.debug("@opentelemetry/api: Unregistering a global for "+t+" v"+x+".");var r=X[$];r&&delete r[t]}var Tn=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],i;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(a){i={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}return s},Sn=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},Ue=(function(){function t(e){this._namespace=e.namespace||"DiagComponentLogger"}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return z("debug",this._namespace,e)},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return z("error",this._namespace,e)},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return z("info",this._namespace,e)},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return z("warn",this._namespace,e)},t.prototype.verbose=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return z("verbose",this._namespace,e)},t})();function z(t,e,r){var n=d("diag");if(n)return r.unshift(e),n[t].apply(n,Sn([],Tn(r),!1))}var u;(function(t){t[t.NONE=0]="NONE",t[t.ERROR=30]="ERROR",t[t.WARN=50]="WARN",t[t.INFO=60]="INFO",t[t.DEBUG=70]="DEBUG",t[t.VERBOSE=80]="VERBOSE",t[t.ALL=9999]="ALL"})(u||(u={}));function De(t,e){t<u.NONE?t=u.NONE:t>u.ALL&&(t=u.ALL),e=e||{};function r(n,o){var s=e[n];return typeof s=="function"&&t>=o?s.bind(e):function(){}}return{error:r("error",u.ERROR),warn:r("warn",u.WARN),info:r("info",u.INFO),debug:r("debug",u.DEBUG),verbose:r("verbose",u.VERBOSE)}}var An=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],i;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(a){i={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}return s},ln=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},fn="diag",l=(function(){function t(){function e(o){return function(){for(var s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];var a=d("diag");if(a)return a[o].apply(a,ln([],An(s),!1))}}var r=this,n=function(o,s){var i,a,c;if(s===void 0&&(s={logLevel:u.INFO}),o===r){var p=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return r.error((i=p.stack)!==null&&i!==void 0?i:p.message),!1}typeof s=="number"&&(s={logLevel:s});var E=d("diag"),f=De((a=s.logLevel)!==null&&a!==void 0?a:u.INFO,o);if(E&&!s.suppressOverrideMessage){var g=(c=new Error().stack)!==null&&c!==void 0?c:"<failed to generate stacktrace>";E.warn("Current logger will be overwritten from "+g),f.warn("Current logger will overwrite one already registered from "+g)}return C("diag",f,r,!0)};r.setLogger=n,r.disable=function(){I(fn,r)},r.createComponentLogger=function(o){return new Ue(o)},r.verbose=e("verbose"),r.debug=e("debug"),r.info=e("info"),r.warn=e("warn"),r.error=e("error")}return t.instance=function(){return this._instance||(this._instance=new t),this._instance},t})();var mn=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],i;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(a){i={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}return s},dn=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ye=(function(){function t(e){this._entries=e?new Map(e):new Map}return t.prototype.getEntry=function(e){var r=this._entries.get(e);if(r)return Object.assign({},r)},t.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(e){var r=mn(e,2),n=r[0],o=r[1];return[n,o]})},t.prototype.setEntry=function(e,r){var n=new t(this._entries);return n._entries.set(e,r),n},t.prototype.removeEntry=function(e){var r=new t(this._entries);return r._entries.delete(e),r},t.prototype.removeEntries=function(){for(var e,r,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var s=new t(this._entries);try{for(var i=dn(n),a=i.next();!a.done;a=i.next()){var c=a.value;s._entries.delete(c)}}catch(p){e={error:p}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return s},t.prototype.clear=function(){return new t},t})();var be=Symbol("BaggageEntryMetadata");var Rn=l.instance();function ve(t){return t===void 0&&(t={}),new ye(new Map(Object.entries(t)))}function qt(t){return typeof t!="string"&&(Rn.error("Cannot create baggage metadata from unknown type: "+typeof t),t=""),{__TYPE__:be,toString:function(){return t}}}function V(t){return Symbol.for(t)}var gn=(function(){function t(e){var r=this;r._currentContext=e?new Map(e):new Map,r.getValue=function(n){return r._currentContext.get(n)},r.setValue=function(n,o){var s=new t(r._currentContext);return s._currentContext.set(n,o),s},r.deleteValue=function(n){var o=new t(r._currentContext);return o._currentContext.delete(n),o}}return t})(),P=new gn;var Ve={get:function(t,e){if(t!=null)return t[e]},keys:function(t){return t==null?[]:Object.keys(t)}},we={set:function(t,e,r){t!=null&&(t[e]=r)}};var hn=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],i;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(a){i={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}return s},On=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},Ge=(function(){function t(){}return t.prototype.active=function(){return P},t.prototype.with=function(e,r,n){for(var o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r.call.apply(r,On([n],hn(o),!1))},t.prototype.bind=function(e,r){return r},t.prototype.enable=function(){return this},t.prototype.disable=function(){return this},t})();var xn=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],i;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(a){i={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}return s},Pn=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},Zt="context",Ln=new Ge,U=(function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalContextManager=function(e){return C(Zt,e,l.instance())},t.prototype.active=function(){return this._getContextManager().active()},t.prototype.with=function(e,r,n){for(var o,s=[],i=3;i<arguments.length;i++)s[i-3]=arguments[i];return(o=this._getContextManager()).with.apply(o,Pn([e,r,n],xn(s),!1))},t.prototype.bind=function(e,r){return this._getContextManager().bind(e,r)},t.prototype._getContextManager=function(){return d(Zt)||Ln},t.prototype.disable=function(){this._getContextManager().disable(),I(Zt,l.instance())},t})();var T;(function(t){t[t.NONE=0]="NONE",t[t.SAMPLED=1]="SAMPLED"})(T||(T={}));var dt="0000000000000000",Rt="00000000000000000000000000000000",J={traceId:Rt,spanId:dt,traceFlags:T.NONE};var D=(function(){function t(e){e===void 0&&(e=J),this._spanContext=e}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(e,r){return this},t.prototype.setAttributes=function(e){return this},t.prototype.addEvent=function(e,r){return this},t.prototype.addLink=function(e){return this},t.prototype.addLinks=function(e){return this},t.prototype.setStatus=function(e){return this},t.prototype.updateName=function(e){return this},t.prototype.end=function(e){},t.prototype.isRecording=function(){return!1},t.prototype.recordException=function(e,r){},t})();var te=V("OpenTelemetry Context Key SPAN");function gt(t){return t.getValue(te)||void 0}function Be(){return gt(U.getInstance().active())}function Q(t,e){return t.setValue(te,e)}function He(t){return t.deleteValue(te)}function Fe(t,e){return Q(t,new D(e))}function ht(t){var e;return(e=gt(t))===null||e===void 0?void 0:e.spanContext()}var Nn=/^([0-9a-f]{32})$/i,Mn=/^[0-9a-f]{16}$/i;function Ot(t){return Nn.test(t)&&t!==Rt}function Ke(t){return Mn.test(t)&&t!==dt}function L(t){return Ot(t.traceId)&&Ke(t.spanId)}function Ye(t){return new D(t)}var ee=U.getInstance(),xt=(function(){function t(){}return t.prototype.startSpan=function(e,r,n){n===void 0&&(n=ee.active());var o=!!r?.root;if(o)return new D;var s=n&&ht(n);return Cn(s)&&L(s)?new D(s):new D},t.prototype.startActiveSpan=function(e,r,n,o){var s,i,a;if(!(arguments.length<2)){arguments.length===2?a=r:arguments.length===3?(s=r,a=n):(s=r,i=n,a=o);var c=i??ee.active(),p=this.startSpan(e,s,c),E=Q(c,p);return ee.with(E,a,void 0,p)}},t})();function Cn(t){return typeof t=="object"&&typeof t.spanId=="string"&&typeof t.traceId=="string"&&typeof t.traceFlags=="number"}var In=new xt,ke=(function(){function t(e,r,n,o){this._provider=e,this.name=r,this.version=n,this.options=o}return t.prototype.startSpan=function(e,r,n){return this._getTracer().startSpan(e,r,n)},t.prototype.startActiveSpan=function(e,r,n,o){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},t.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):In},t})();var je=(function(){function t(){}return t.prototype.getTracer=function(e,r,n){return new xt},t})();var Un=new je,re=(function(){function t(){}return t.prototype.getTracer=function(e,r,n){var o;return(o=this.getDelegateTracer(e,r,n))!==null&&o!==void 0?o:new ke(this,e,r,n)},t.prototype.getDelegate=function(){var e;return(e=this._delegate)!==null&&e!==void 0?e:Un},t.prototype.setDelegate=function(e){this._delegate=e},t.prototype.getDelegateTracer=function(e,r,n){var o;return(o=this._delegate)===null||o===void 0?void 0:o.getTracer(e,r,n)},t})();var Y;(function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(Y||(Y={}));var q;(function(t){t[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"})(q||(q={}));var Z;(function(t){t[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"})(Z||(Z={}));var R=U.getInstance();var _=l.instance();var We=(function(){function t(){}return t.prototype.inject=function(e,r){},t.prototype.extract=function(e,r){return e},t.prototype.fields=function(){return[]},t})();var ne=V("OpenTelemetry Baggage Key");function oe(t){return t.getValue(ne)||void 0}function $e(){return oe(U.getInstance().active())}function Xe(t,e){return t.setValue(ne,e)}function ze(t){return t.deleteValue(ne)}var se="propagation",Dn=new We,Je=(function(){function t(){this.createBaggage=ve,this.getBaggage=oe,this.getActiveBaggage=$e,this.setBaggage=Xe,this.deleteBaggage=ze}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalPropagator=function(e){return C(se,e,l.instance())},t.prototype.inject=function(e,r,n){return n===void 0&&(n=we),this._getGlobalPropagator().inject(e,r,n)},t.prototype.extract=function(e,r,n){return n===void 0&&(n=Ve),this._getGlobalPropagator().extract(e,r,n)},t.prototype.fields=function(){return this._getGlobalPropagator().fields()},t.prototype.disable=function(){I(se,l.instance())},t.prototype._getGlobalPropagator=function(){return d(se)||Dn},t})();var y=Je.getInstance();var ie="trace",Qe=(function(){function t(){this._proxyTracerProvider=new re,this.wrapSpanContext=Ye,this.isSpanContextValid=L,this.deleteSpan=He,this.getSpan=gt,this.getActiveSpan=Be,this.getSpanContext=ht,this.setSpan=Q,this.setSpanContext=Fe}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalTracerProvider=function(e){var r=C(ie,this._proxyTracerProvider,l.instance());return r&&this._proxyTracerProvider.setDelegate(e),r},t.prototype.getTracerProvider=function(){return d(ie)||this._proxyTracerProvider},t.prototype.getTracer=function(e,r){return this.getTracerProvider().getTracer(e,r)},t.prototype.disable=function(){I(ie,l.instance()),this._proxyTracerProvider=new re},t})();var S=Qe.getInstance();var qe=V("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function ae(t){return t.setValue(qe,!0)}function w(t){return t.getValue(qe)===!0}var Pt="baggage";function Ze(t){return t.reduce((e,r)=>{let n=`${e}${e!==""?",":""}${r}`;return n.length>8192?e:n},"")}function tr(t){return t.getAllEntries().map(([e,r])=>{let n=`${encodeURIComponent(e)}=${encodeURIComponent(r.value)}`;return r.metadata!==void 0&&(n+=";"+r.metadata.toString()),n})}function er(t){if(!t)return;let e=t.indexOf(";"),r=e===-1?t:t.substring(0,e),n=r.indexOf("=");if(n<=0)return;let o=r.substring(0,n).trim(),s=r.substring(n+1).trim();if(!o||!s)return;let i,a;try{i=decodeURIComponent(o),a=decodeURIComponent(s)}catch{return}let c;if(e!==-1&&e<t.length-1){let p=t.substring(e+1);c=qt(p)}return{key:i,value:a,metadata:c}}var tt=class{inject(e,r,n){let o=y.getBaggage(e);if(!o||w(e))return;let s=tr(o).filter(a=>a.length<=4096).slice(0,180),i=Ze(s);i.length>0&&n.set(r,Pt,i)}extract(e,r,n){let o=n.get(r,Pt),s=Array.isArray(o)?o.join(","):o;if(!s)return e;let i={};return s.length===0||(s.split(",").forEach(c=>{let p=er(c);if(p){let E={value:p.value};p.metadata&&(E.metadata=p.metadata),i[p.key]=E}}),Object.entries(i).length===0)?e:y.setBaggage(e,y.createBaggage(i))}fields(){return[Pt]}};function G(t){let e={};if(typeof t!="object"||t==null)return e;for(let r in t){if(!Object.prototype.hasOwnProperty.call(t,r))continue;if(!wn(r)){_.warn(`Invalid attribute key: ${r}`);continue}let n=t[r];if(!Lt(n)){_.warn(`Invalid attribute value set for key: ${r}`);continue}Array.isArray(n)?e[r]=n.slice():e[r]=n}return e}function wn(t){return typeof t=="string"&&t!==""}function Lt(t){return t==null?!0:Array.isArray(t)?Gn(t):rr(typeof t)}function Gn(t){let e;for(let r of t){if(r==null)continue;let n=typeof r;if(n!==e){if(!e){if(rr(n)){e=n;continue}return!1}return!1}}return!0}function rr(t){switch(t){case"number":case"boolean":case"string":return!0}return!1}function nr(){return t=>{_.error(Bn(t))}}function Bn(t){return typeof t=="string"?t:JSON.stringify(Hn(t))}function Hn(t){let e={},r=t;for(;r!==null;)Object.getOwnPropertyNames(r).forEach(n=>{if(e[n])return;let o=r[n];o&&(e[n]=String(o))}),r=Object.getPrototypeOf(r);return e}var Fn=nr();function B(t){try{Fn(t)}catch{}}var or="2.5.0";function sr(t){let e={},r=t.length;for(let n=0;n<r;n++){let o=t[n];o&&(e[String(o).toUpperCase().replace(/[-.]/g,"_")]=o)}return e}var Kn="cloud.provider",Yn="cloud.account.id",kn="cloud.region",jn="cloud.availability_zone",Wn="cloud.platform",$n="aws.ecs.container.arn",Xn="aws.ecs.cluster.arn",zn="aws.ecs.launchtype",Jn="aws.ecs.task.arn",Qn="aws.ecs.task.family",qn="aws.ecs.task.revision",Zn="aws.eks.cluster.arn",to="aws.log.group.names",eo="aws.log.group.arns",ro="aws.log.stream.names",no="aws.log.stream.arns",oo="container.name",so="container.id",io="container.runtime",ao="container.image.name",co="container.image.tag",_o="deployment.environment",po="device.id",Eo="device.model.identifier",uo="device.model.name",To="faas.name",So="faas.id",Ao="faas.version",lo="faas.instance",fo="faas.max_memory",mo="host.id",Ro="host.name",go="host.type",ho="host.arch",Oo="host.image.name",xo="host.image.id",Po="host.image.version",Lo="k8s.cluster.name",No="k8s.node.name",Mo="k8s.node.uid",Co="k8s.namespace.name",Io="k8s.pod.uid",Uo="k8s.pod.name",Do="k8s.container.name",yo="k8s.replicaset.uid",bo="k8s.replicaset.name",vo="k8s.deployment.uid",Vo="k8s.deployment.name",wo="k8s.statefulset.uid",Go="k8s.statefulset.name",Bo="k8s.daemonset.uid",Ho="k8s.daemonset.name",Fo="k8s.job.uid",Ko="k8s.job.name",Yo="k8s.cronjob.uid",ko="k8s.cronjob.name",jo="os.type",Wo="os.description",$o="os.name",Xo="os.version",zo="process.pid",Jo="process.executable.name",Qo="process.executable.path",qo="process.command",Zo="process.command_line",ts="process.command_args",es="process.owner",rs="process.runtime.name",ns="process.runtime.version",os="process.runtime.description",ss="service.name",is="service.namespace",as="service.instance.id",cs="service.version",_s="telemetry.sdk.name",ps="telemetry.sdk.language",Es="telemetry.sdk.version",us="telemetry.auto.version",Ts="webengine.name",Ss="webengine.version",As="webengine.description";var ir=sr([Kn,Yn,kn,jn,Wn,$n,Xn,zn,Jn,Qn,qn,Zn,to,eo,ro,no,oo,so,io,ao,co,_o,po,Eo,uo,To,So,Ao,lo,fo,mo,Ro,go,ho,Oo,xo,Po,Lo,No,Mo,Co,Io,Uo,Do,yo,bo,vo,Vo,wo,Go,Bo,Ho,Fo,Ko,Yo,ko,jo,Wo,$o,Xo,zo,Jo,Qo,qo,Zo,ts,es,rs,ns,os,ss,is,as,cs,_s,ps,Es,us,Ts,Ss,As]);var Nt="exception.message",ar="exception.stacktrace",Mt="exception.type";var cr="service.name";var et="telemetry.sdk.language";var _r="webjs",rt="telemetry.sdk.name",nt="telemetry.sdk.version";var pr="process.runtime.name";var k={[rt]:"opentelemetry",[pr]:"browser",[et]:_r,[nt]:or};var N=performance;var ls=9,fs=6,ms=Math.pow(10,fs),Ct=Math.pow(10,ls);function b(t){let e=t/1e3,r=Math.trunc(e),n=Math.round(t%1e3*ms);return[r,n]}function _e(t){let e=b(N.timeOrigin),r=b(typeof t=="number"?t:N.now());return yt(e,r)}function pe(t,e){let r=e[0]-t[0],n=e[1]-t[1];return n<0&&(r-=1,n+=Ct),[r,n]}function Ee(t){return t[0]*Ct+t[1]}function It(t){return t[0]*1e6+t[1]/1e3}function Ut(t){return Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number"}function Dt(t){return Ut(t)||typeof t=="number"||t instanceof Date}function yt(t,e){let r=[t[0]+e[0],t[1]+e[1]];return r[1]>=Ct&&(r[1]-=Ct,r[0]+=1),r}var A;(function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"})(A||(A={}));var ot=class{_propagators;_fields;constructor(e={}){this._propagators=e.propagators??[],this._fields=Array.from(new Set(this._propagators.map(r=>typeof r.fields=="function"?r.fields():[]).reduce((r,n)=>r.concat(n),[])))}inject(e,r,n){for(let o of this._propagators)try{o.inject(e,r,n)}catch(s){_.warn(`Failed to inject with ${o.constructor.name}. Err: ${s.message}`)}}extract(e,r,n){return this._propagators.reduce((o,s)=>{try{return s.extract(o,r,n)}catch(i){_.warn(`Failed to extract with ${s.constructor.name}. Err: ${i.message}`)}return o},e)}fields(){return this._fields.slice()}};var ue="[_0-9a-z-*/]",ds=`[a-z]${ue}{0,255}`,Rs=`[a-z0-9]${ue}{0,240}@[a-z]${ue}{0,13}`,gs=new RegExp(`^(?:${ds}|${Rs})$`),hs=/^[ -~]{0,255}[!-~]$/,Os=/,|=/;function Er(t){return gs.test(t)}function ur(t){return hs.test(t)&&!Os.test(t)}var Tr=32,xs=512,Sr=",",Ar="=",bt=class t{_internalState=new Map;constructor(e){e&&this._parse(e)}set(e,r){let n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,r),n}unset(e){let r=this._clone();return r._internalState.delete(e),r}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce((e,r)=>(e.push(r+Ar+this.get(r)),e),[]).join(Sr)}_parse(e){e.length>xs||(this._internalState=e.split(Sr).reverse().reduce((r,n)=>{let o=n.trim(),s=o.indexOf(Ar);if(s!==-1){let i=o.slice(0,s),a=o.slice(s+1,n.length);Er(i)&&ur(a)&&r.set(i,a)}return r},new Map),this._internalState.size>Tr&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,Tr))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let e=new t;return e._internalState=new Map(this._internalState),e}};var vt="traceparent",Vt="tracestate",Ps="00",Ls="(?!ff)[\\da-f]{2}",Ns="(?![0]{32})[\\da-f]{32}",Ms="(?![0]{16})[\\da-f]{16}",Cs="[\\da-f]{2}",Is=new RegExp(`^\\s?(${Ls})-(${Ns})-(${Ms})-(${Cs})(-.*)?\\s?$`);function lr(t){let e=Is.exec(t);return!e||e[1]==="00"&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}}var st=class{inject(e,r,n){let o=S.getSpanContext(e);if(!o||w(e)||!L(o))return;let s=`${Ps}-${o.traceId}-${o.spanId}-0${Number(o.traceFlags||T.NONE).toString(16)}`;n.set(r,vt,s),o.traceState&&n.set(r,Vt,o.traceState.serialize())}extract(e,r,n){let o=n.get(r,vt);if(!o)return e;let s=Array.isArray(o)?o[0]:o;if(typeof s!="string")return e;let i=lr(s);if(!i)return e;i.isRemote=!0;let a=n.get(r,Vt);if(a){let c=Array.isArray(a)?a.join(","):a;i.traceState=new bt(typeof c=="string"?c:void 0)}return S.setSpanContext(e,i)}fields(){return[vt,Vt]}};var Us="[object Object]",Ds="[object Null]",ys="[object Undefined]",bs=Function.prototype,fr=bs.toString,vs=fr.call(Object),Vs=Object.getPrototypeOf,mr=Object.prototype,dr=mr.hasOwnProperty,H=Symbol?Symbol.toStringTag:void 0,Rr=mr.toString;function Te(t){if(!ws(t)||Gs(t)!==Us)return!1;let e=Vs(t);if(e===null)return!0;let r=dr.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&fr.call(r)===vs}function ws(t){return t!=null&&typeof t=="object"}function Gs(t){return t==null?t===void 0?ys:Ds:H&&H in Object(t)?Bs(t):Hs(t)}function Bs(t){let e=dr.call(t,H),r=t[H],n=!1;try{t[H]=void 0,n=!0}catch{}let o=Rr.call(t);return n&&(e?t[H]=r:delete t[H]),o}function Hs(t){return Rr.call(t)}var Fs=20;function Ae(...t){let e=t.shift(),r=new WeakMap;for(;t.length>0;)e=hr(e,t.shift(),0,r);return e}function Se(t){return Gt(t)?t.slice():t}function hr(t,e,r=0,n){let o;if(!(r>Fs)){if(r++,wt(t)||wt(e)||Or(e))o=Se(e);else if(Gt(t)){if(o=t.slice(),Gt(e))for(let s=0,i=e.length;s<i;s++)o.push(Se(e[s]));else if(it(e)){let s=Object.keys(e);for(let i=0,a=s.length;i<a;i++){let c=s[i];o[c]=Se(e[c])}}}else if(it(t))if(it(e)){if(!Ks(t,e))return e;o=Object.assign({},t);let s=Object.keys(e);for(let i=0,a=s.length;i<a;i++){let c=s[i],p=e[c];if(wt(p))typeof p>"u"?delete o[c]:o[c]=p;else{let E=o[c],f=p;if(gr(t,c,n)||gr(e,c,n))delete o[c];else{if(it(E)&&it(f)){let g=n.get(E)||[],m=n.get(f)||[];g.push({obj:t,key:c}),m.push({obj:e,key:c}),n.set(E,g),n.set(f,m)}o[c]=hr(o[c],p,r,n)}}}}else o=e;return o}}function gr(t,e,r){let n=r.get(t[e])||[];for(let o=0,s=n.length;o<s;o++){let i=n[o];if(i.key===e&&i.obj===t)return!0}return!1}function Gt(t){return Array.isArray(t)}function Or(t){return typeof t=="function"}function it(t){return!wt(t)&&!Gt(t)&&!Or(t)&&typeof t=="object"}function wt(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t>"u"||t instanceof Date||t instanceof RegExp||t===null}function Ks(t,e){return!(!Te(t)||!Te(e))}var Bt=class{_promise;_resolve;_reject;constructor(){this._promise=new Promise((e,r)=>{this._resolve=e,this._reject=r})}get promise(){return this._promise}resolve(e){this._resolve(e)}reject(e){this._reject(e)}};var at=class{_isCalled=!1;_deferred=new Bt;_callback;_that;constructor(e,r){this._callback=e,this._that=r}get isCalled(){return this._isCalled}get promise(){return this._deferred.promise}call(...e){if(!this._isCalled){this._isCalled=!0;try{Promise.resolve(this._callback.call(this._that,...e)).then(r=>this._deferred.resolve(r),r=>this._deferred.reject(r))}catch(r){this._deferred.reject(r)}}return this._deferred.promise}};function xr(t,e){return new Promise(r=>{R.with(ae(R.active()),()=>{t.export(e,n=>{r(n)})})})}var Pr={_export:xr};var Ht;function Lr(){if(Ht===void 0)try{let t=globalThis.process.argv0;Ht=t?`unknown_service:${t}`:"unknown_service"}catch{Ht="unknown_service"}return Ht}var j=t=>t!==null&&typeof t=="object"&&typeof t.then=="function";var le=class t{_rawAttributes;_asyncAttributesPending=!1;_schemaUrl;_memoizedAttributes;static FromAttributeList(e,r){let n=new t({},r);return n._rawAttributes=Nr(e),n._asyncAttributesPending=e.filter(([o,s])=>j(s)).length>0,n}constructor(e,r){let n=e.attributes??{};this._rawAttributes=Object.entries(n).map(([o,s])=>(j(s)&&(this._asyncAttributesPending=!0),[o,s])),this._rawAttributes=Nr(this._rawAttributes),this._schemaUrl=Ys(r?.schemaUrl)}get asyncAttributesPending(){return this._asyncAttributesPending}async waitForAsyncAttributes(){if(this.asyncAttributesPending){for(let e=0;e<this._rawAttributes.length;e++){let[r,n]=this._rawAttributes[e];this._rawAttributes[e]=[r,j(n)?await n:n]}this._asyncAttributesPending=!1}}get attributes(){if(this.asyncAttributesPending&&_.error("Accessing resource attributes before async attributes settled"),this._memoizedAttributes)return this._memoizedAttributes;let e={};for(let[r,n]of this._rawAttributes){if(j(n)){_.debug(`Unsettled resource attribute ${r} skipped`);continue}n!=null&&(e[r]??=n)}return this._asyncAttributesPending||(this._memoizedAttributes=e),e}getRawAttributes(){return this._rawAttributes}get schemaUrl(){return this._schemaUrl}merge(e){if(e==null)return this;let r=ks(this,e),n=r?{schemaUrl:r}:void 0;return t.FromAttributeList([...e.getRawAttributes(),...this.getRawAttributes()],n)}};function Ft(t,e){return le.FromAttributeList(Object.entries(t),e)}function fe(){return Ft({[cr]:Lr(),[et]:k[et],[rt]:k[rt],[nt]:k[nt]})}function Nr(t){return t.map(([e,r])=>j(r)?[e,r.catch(n=>{_.debug("promise rejection for resource attribute: %s - %s",e,n)})]:[e,r])}function Ys(t){if(typeof t=="string"||t===void 0)return t;_.warn("Schema URL must be string or undefined, got %s. Schema URL will be ignored.",t)}function ks(t,e){let r=t?.schemaUrl,n=e?.schemaUrl,o=r===void 0||r==="",s=n===void 0||n==="";if(o)return n;if(s||r===n)return r;_.warn('Schema URL merge conflict: old resource has "%s", updating resource has "%s". Resulting resource will have undefined Schema URL.',r,n)}var Mr="exception";var Kt=class{_spanContext;kind;parentSpanContext;attributes={};links=[];events=[];startTime;resource;instrumentationScope;_droppedAttributesCount=0;_droppedEventsCount=0;_droppedLinksCount=0;name;status={code:Z.UNSET};endTime=[0,0];_ended=!1;_duration=[-1,-1];_spanProcessor;_spanLimits;_attributeValueLengthLimit;_performanceStartTime;_performanceOffset;_startTimeProvided;constructor(e){let r=Date.now();this._spanContext=e.spanContext,this._performanceStartTime=N.now(),this._performanceOffset=r-(this._performanceStartTime+N.timeOrigin),this._startTimeProvided=e.startTime!=null,this._spanLimits=e.spanLimits,this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,this._spanProcessor=e.spanProcessor,this.name=e.name,this.parentSpanContext=e.parentSpanContext,this.kind=e.kind,this.links=e.links||[],this.startTime=this._getTime(e.startTime??r),this.resource=e.resource,this.instrumentationScope=e.scope,e.attributes!=null&&this.setAttributes(e.attributes),this._spanProcessor.onStart(this,e.context)}spanContext(){return this._spanContext}setAttribute(e,r){if(r==null||this._isSpanEnded())return this;if(e.length===0)return _.warn(`Invalid attribute key: ${e}`),this;if(!Lt(r))return _.warn(`Invalid attribute value set for key: ${e}`),this;let{attributeCountLimit:n}=this._spanLimits;return n!==void 0&&Object.keys(this.attributes).length>=n&&!Object.prototype.hasOwnProperty.call(this.attributes,e)?(this._droppedAttributesCount++,this):(this.attributes[e]=this._truncateToSize(r),this)}setAttributes(e){for(let[r,n]of Object.entries(e))this.setAttribute(r,n);return this}addEvent(e,r,n){if(this._isSpanEnded())return this;let{eventCountLimit:o}=this._spanLimits;if(o===0)return _.warn("No events allowed."),this._droppedEventsCount++,this;o!==void 0&&this.events.length>=o&&(this._droppedEventsCount===0&&_.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),Dt(r)&&(Dt(n)||(n=r),r=void 0);let s=G(r);return this.events.push({name:e,attributes:s,time:this._getTime(n),droppedAttributesCount:0}),this}addLink(e){return this.links.push(e),this}addLinks(e){return this.links.push(...e),this}setStatus(e){return this._isSpanEnded()?this:(this.status={...e},this.status.message!=null&&typeof e.message!="string"&&(_.warn(`Dropping invalid status.message of type '${typeof e.message}', expected 'string'`),delete this.status.message),this)}updateName(e){return this._isSpanEnded()?this:(this.name=e,this)}end(e){if(this._isSpanEnded()){_.error(`${this.name} ${this._spanContext.traceId}-${this._spanContext.spanId} - You can only call end() on a span once.`);return}this.endTime=this._getTime(e),this._duration=pe(this.startTime,this.endTime),this._duration[0]<0&&(_.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&_.warn(`Dropped ${this._droppedEventsCount} events because eventCountLimit reached`),this._spanProcessor.onEnding&&this._spanProcessor.onEnding(this),this._ended=!0,this._spanProcessor.onEnd(this)}_getTime(e){if(typeof e=="number"&&e<=N.now())return _e(e+this._performanceOffset);if(typeof e=="number")return b(e);if(e instanceof Date)return b(e.getTime());if(Ut(e))return e;if(this._startTimeProvided)return b(Date.now());let r=N.now()-this._performanceStartTime;return yt(this.startTime,b(r))}isRecording(){return this._ended===!1}recordException(e,r){let n={};typeof e=="string"?n[Nt]=e:e&&(e.code?n[Mt]=e.code.toString():e.name&&(n[Mt]=e.name),e.message&&(n[Nt]=e.message),e.stack&&(n[ar]=e.stack)),n[Mt]||n[Nt]?this.addEvent(Mr,n,r):_.warn(`Failed to record an exception ${e}`)}get duration(){return this._duration}get ended(){return this._ended}get droppedAttributesCount(){return this._droppedAttributesCount}get droppedEventsCount(){return this._droppedEventsCount}get droppedLinksCount(){return this._droppedLinksCount}_isSpanEnded(){if(this._ended){let e=new Error(`Operation attempted on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`);_.warn(`Cannot execute the operation on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`,e)}return this._ended}_truncateToLimitUtil(e,r){return e.length<=r?e:e.substring(0,r)}_truncateToSize(e){let r=this._attributeValueLengthLimit;return r<=0?(_.warn(`Attribute value limit must be positive, got ${r}`),e):typeof e=="string"?this._truncateToLimitUtil(e,r):Array.isArray(e)?e.map(n=>typeof n=="string"?this._truncateToLimitUtil(n,r):n):e}};var M;(function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(M||(M={}));var v=class{shouldSample(){return{decision:M.NOT_RECORD}}toString(){return"AlwaysOffSampler"}};var h=class{shouldSample(){return{decision:M.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}};var F=class{_root;_remoteParentSampled;_remoteParentNotSampled;_localParentSampled;_localParentNotSampled;constructor(e){this._root=e.root,this._root||(B(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new h),this._remoteParentSampled=e.remoteParentSampled??new h,this._remoteParentNotSampled=e.remoteParentNotSampled??new v,this._localParentSampled=e.localParentSampled??new h,this._localParentNotSampled=e.localParentNotSampled??new v}shouldSample(e,r,n,o,s,i){let a=S.getSpanContext(e);return!a||!L(a)?this._root.shouldSample(e,r,n,o,s,i):a.isRemote?a.traceFlags&T.SAMPLED?this._remoteParentSampled.shouldSample(e,r,n,o,s,i):this._remoteParentNotSampled.shouldSample(e,r,n,o,s,i):a.traceFlags&T.SAMPLED?this._localParentSampled.shouldSample(e,r,n,o,s,i):this._localParentNotSampled.shouldSample(e,r,n,o,s,i)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}};var ct=class{_ratio;_upperBound;constructor(e=0){this._ratio=this._normalize(e),this._upperBound=Math.floor(this._ratio*4294967295)}shouldSample(e,r){return{decision:Ot(r)&&this._accumulate(r)<this._upperBound?M.RECORD_AND_SAMPLED:M.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(e){return typeof e!="number"||isNaN(e)?0:e>=1?1:e<=0?0:e}_accumulate(e){let r=0;for(let n=0;n<e.length/8;n++){let o=n*8,s=parseInt(e.slice(o,o+8),16);r=(r^s)>>>0}return r}};var O;(function(t){t.AlwaysOff="always_off",t.AlwaysOn="always_on",t.ParentBasedAlwaysOff="parentbased_always_off",t.ParentBasedAlwaysOn="parentbased_always_on",t.ParentBasedTraceIdRatio="parentbased_traceidratio",t.TraceIdRatio="traceidratio"})(O||(O={}));var Yt=1;function kt(){return{sampler:me(),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:void 0??1/0,attributeCountLimit:void 0??128},spanLimits:{attributeValueLengthLimit:void 0??1/0,attributeCountLimit:void 0??128,linkCountLimit:void 0??128,eventCountLimit:void 0??128,attributePerEventCountLimit:void 0??128,attributePerLinkCountLimit:void 0??128}}}function me(){let t=void 0??O.ParentBasedAlwaysOn;switch(t){case O.AlwaysOn:return new h;case O.AlwaysOff:return new v;case O.ParentBasedAlwaysOn:return new F({root:new h});case O.ParentBasedAlwaysOff:return new F({root:new v});case O.TraceIdRatio:return new ct(Cr());case O.ParentBasedTraceIdRatio:return new F({root:new ct(Cr())});default:return _.error(`OTEL_TRACES_SAMPLER value "${t}" invalid, defaulting to "${O.ParentBasedAlwaysOn}".`),new F({root:new h})}}function Cr(){let t=void 0;return t==null?(_.error(`OTEL_TRACES_SAMPLER_ARG is blank, defaulting to ${Yt}.`),Yt):t<0||t>1?(_.error(`OTEL_TRACES_SAMPLER_ARG=${t} was given, but it is out of range ([0..1]), defaulting to ${Yt}.`),Yt):t}var js=128,Ws=1/0;function Ir(t){let e={sampler:me()},r=kt(),n=Object.assign({},r,e,t);return n.generalLimits=Object.assign({},r.generalLimits,t.generalLimits||{}),n.spanLimits=Object.assign({},r.spanLimits,t.spanLimits||{}),n}function Ur(t){let e=Object.assign({},t.spanLimits);return e.attributeCountLimit=t.spanLimits?.attributeCountLimit??t.generalLimits?.attributeCountLimit??void 0??void 0??js,e.attributeValueLengthLimit=t.spanLimits?.attributeValueLengthLimit??t.generalLimits?.attributeValueLengthLimit??void 0??void 0??Ws,Object.assign({},t,{spanLimits:e})}var _t=class{generateTraceId=Dr(16);generateSpanId=Dr(8)},jt=Array(32);function Dr(t){return function(){for(let r=0;r<t*2;r++)jt[r]=Math.floor(Math.random()*16)+48,jt[r]>=58&&(jt[r]+=39);return String.fromCharCode.apply(null,jt.slice(0,t*2))}}var Wt=class{_sampler;_generalLimits;_spanLimits;_idGenerator;instrumentationScope;_resource;_spanProcessor;constructor(e,r,n,o){let s=Ir(r);this._sampler=s.sampler,this._generalLimits=s.generalLimits,this._spanLimits=s.spanLimits,this._idGenerator=r.idGenerator||new _t,this._resource=n,this._spanProcessor=o,this.instrumentationScope=e}startSpan(e,r={},n=R.active()){r.root&&(n=S.deleteSpan(n));let o=S.getSpan(n);if(w(n))return _.debug("Instrumentation suppressed, returning Noop Span"),S.wrapSpanContext(J);let s=o?.spanContext(),i=this._idGenerator.generateSpanId(),a,c,p;!s||!S.isSpanContextValid(s)?c=this._idGenerator.generateTraceId():(c=s.traceId,p=s.traceState,a=s);let E=r.kind??q.INTERNAL,f=(r.links??[]).map(mt=>({context:mt.context,attributes:G(mt.attributes)})),g=G(r.attributes),m=this._sampler.shouldSample(n,c,e,E,g,f);p=m.traceState??p;let Qt=m.decision===Y.RECORD_AND_SAMPLED?T.SAMPLED:T.NONE,ft={traceId:c,spanId:i,traceFlags:Qt,traceState:p};if(m.decision===Y.NOT_RECORD)return _.debug("Recording is off, propagating context in a non-recording span"),S.wrapSpanContext(ft);let pn=G(Object.assign(g,m.attributes));return new Kt({resource:this._resource,scope:this.instrumentationScope,context:n,spanContext:ft,name:e,kind:E,links:f,parentSpanContext:a,attributes:pn,startTime:r.startTime,spanProcessor:this._spanProcessor,spanLimits:this._spanLimits})}startActiveSpan(e,r,n,o){let s,i,a;if(arguments.length<2)return;arguments.length===2?a=r:arguments.length===3?(s=r,a=n):(s=r,i=n,a=o);let c=i??R.active(),p=this.startSpan(e,s,c),E=S.setSpan(c,p);return R.with(E,a,void 0,p)}getGeneralLimits(){return this._generalLimits}getSpanLimits(){return this._spanLimits}};var $t=class{_spanProcessors;constructor(e){this._spanProcessors=e}forceFlush(){let e=[];for(let r of this._spanProcessors)e.push(r.forceFlush());return new Promise(r=>{Promise.all(e).then(()=>{r()}).catch(n=>{B(n||new Error("MultiSpanProcessor: forceFlush failed")),r()})})}onStart(e,r){for(let n of this._spanProcessors)n.onStart(e,r)}onEnding(e){for(let r of this._spanProcessors)r.onEnding&&r.onEnding(e)}onEnd(e){for(let r of this._spanProcessors)r.onEnd(e)}shutdown(){let e=[];for(let r of this._spanProcessors)e.push(r.shutdown());return new Promise((r,n)=>{Promise.all(e).then(()=>{r()},n)})}};var K;(function(t){t[t.resolved=0]="resolved",t[t.timeout=1]="timeout",t[t.error=2]="error",t[t.unresolved=3]="unresolved"})(K||(K={}));var pt=class{_config;_tracers=new Map;_resource;_activeSpanProcessor;constructor(e={}){let r=Ae({},kt(),Ur(e));this._resource=r.resource??fe(),this._config=Object.assign({},r,{resource:this._resource});let n=[];e.spanProcessors?.length&&n.push(...e.spanProcessors),this._activeSpanProcessor=new $t(n)}getTracer(e,r,n){let o=`${e}@${r||""}:${n?.schemaUrl||""}`;return this._tracers.has(o)||this._tracers.set(o,new Wt({name:e,version:r,schemaUrl:n?.schemaUrl},this._config,this._resource,this._activeSpanProcessor)),this._tracers.get(o)}forceFlush(){let e=this._config.forceFlushTimeoutMillis,r=this._activeSpanProcessor._spanProcessors.map(n=>new Promise(o=>{let s,i=setTimeout(()=>{o(new Error(`Span processor did not completed within timeout period of ${e} ms`)),s=K.timeout},e);n.forceFlush().then(()=>{clearTimeout(i),s!==K.timeout&&(s=K.resolved,o(s))}).catch(a=>{clearTimeout(i),s=K.error,o(a)})}));return new Promise((n,o)=>{Promise.all(r).then(s=>{let i=s.filter(a=>a!==K.resolved);i.length>0?o(i):n()}).catch(s=>o([s]))})}shutdown(){return this._activeSpanProcessor.shutdown()}};var Et=class{export(e,r){return this._sendSpans(e,r)}shutdown(){return this._sendSpans([]),this.forceFlush()}forceFlush(){return Promise.resolve()}_exportInfo(e){return{resource:{attributes:e.resource.attributes},instrumentationScope:e.instrumentationScope,traceId:e.spanContext().traceId,parentSpanContext:e.parentSpanContext,traceState:e.spanContext().traceState?.serialize(),name:e.name,id:e.spanContext().spanId,kind:e.kind,timestamp:It(e.startTime),duration:It(e.duration),attributes:e.attributes,status:e.status,events:e.events,links:e.links}}_sendSpans(e,r){for(let n of e)console.dir(this._exportInfo(n),{depth:3});if(r)return r({code:A.SUCCESS})}};var ut=class{_exporter;_shutdownOnce;_pendingExports;constructor(e){this._exporter=e,this._shutdownOnce=new at(this._shutdown,this),this._pendingExports=new Set}async forceFlush(){await Promise.all(Array.from(this._pendingExports)),this._exporter.forceFlush&&await this._exporter.forceFlush()}onStart(e,r){}onEnd(e){if(this._shutdownOnce.isCalled||(e.spanContext().traceFlags&T.SAMPLED)===0)return;let r=this._doExport(e).catch(n=>B(n));this._pendingExports.add(r),r.finally(()=>this._pendingExports.delete(r))}async _doExport(e){e.resource.asyncAttributesPending&&await e.resource.waitForAsyncAttributes?.();let r=await Pr._export(this._exporter,[e]);if(r.code!==A.SUCCESS)throw r.error??new Error(`SimpleSpanProcessor: span export failed (status ${r})`)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return this._exporter.shutdown()}};var Xt=class{_enabled=!1;_currentContext=P;_bindFunction(e=P,r){let n=this,o=function(...s){return n.with(e,()=>r.apply(this,s))};return Object.defineProperty(o,"length",{enumerable:!1,configurable:!0,writable:!1,value:r.length}),o}active(){return this._currentContext}bind(e,r){return e===void 0&&(e=this.active()),typeof r=="function"?this._bindFunction(e,r):r}disable(){return this._currentContext=P,this._enabled=!1,this}enable(){return this._enabled?this:(this._enabled=!0,this._currentContext=P,this)}with(e,r,n,...o){let s=this._currentContext;this._currentContext=e||P;try{return r.call(n,...o)}finally{this._currentContext=s}}};function $s(t){if(t!==null){if(t===void 0){let e=new Xt;e.enable(),R.setGlobalContextManager(e);return}t.enable(),R.setGlobalContextManager(t)}}function Xs(t){if(t!==null){if(t===void 0){y.setGlobalPropagator(new ot({propagators:[new st,new tt]}));return}y.setGlobalPropagator(t)}}var Tt=class extends pt{constructor(e={}){super(e)}register(e={}){S.setGlobalTracerProvider(this),Xs(e.propagator),$s(e.contextManager)}};var St=class{_delegate;constructor(e){this._delegate=e}export(e,r){this._delegate.export(e,r)}forceFlush(){return this._delegate.forceFlush()}shutdown(){return this._delegate.shutdown()}};var At=class extends Error{code;name="OTLPExporterError";data;constructor(e,r,n){super(e),this.data=n,this.code=r}};function zs(t){if(Number.isFinite(t)&&t>0)return t;throw new Error(`Configuration: timeoutMillis is invalid, expected number greater than 0 (actual: '${t}')`)}function yr(t){if(t!=null)return async()=>t}function br(t,e,r){return{timeoutMillis:zs(t.timeoutMillis??e.timeoutMillis??r.timeoutMillis),concurrencyLimit:t.concurrencyLimit??e.concurrencyLimit??r.concurrencyLimit,compression:t.compression??e.compression??r.compression}}function vr(){return{timeoutMillis:1e4,concurrencyLimit:30,compression:"none"}}var de=class{_concurrencyLimit;_sendingPromises=[];constructor(e){this._concurrencyLimit=e}pushPromise(e){if(this.hasReachedLimit())throw new Error("Concurrency Limit reached");this._sendingPromises.push(e);let r=()=>{let n=this._sendingPromises.indexOf(e);this._sendingPromises.splice(n,1)};e.then(r,r)}hasReachedLimit(){return this._sendingPromises.length>=this._concurrencyLimit}async awaitAll(){await Promise.all(this._sendingPromises)}};function Vr(t){return new de(t.concurrencyLimit)}function Js(t){return Object.prototype.hasOwnProperty.call(t,"partialSuccess")}function wr(){return{handleResponse(t){t==null||!Js(t)||t.partialSuccess==null||Object.keys(t.partialSuccess).length===0||_.warn("Received Partial Success response:",JSON.stringify(t.partialSuccess))}}}var Re=class{_diagLogger;_transport;_serializer;_responseHandler;_promiseQueue;_timeout;constructor(e,r,n,o,s){this._transport=e,this._serializer=r,this._responseHandler=n,this._promiseQueue=o,this._timeout=s,this._diagLogger=_.createComponentLogger({namespace:"OTLPExportDelegate"})}export(e,r){if(this._diagLogger.debug("items to be sent",e),this._promiseQueue.hasReachedLimit()){r({code:A.FAILED,error:new Error("Concurrent export limit reached")});return}let n=this._serializer.serializeRequest(e);if(n==null){r({code:A.FAILED,error:new Error("Nothing to send")});return}this._promiseQueue.pushPromise(this._transport.send(n,this._timeout).then(o=>{if(o.status==="success"){if(o.data!=null)try{this._responseHandler.handleResponse(this._serializer.deserializeResponse(o.data))}catch(s){this._diagLogger.warn("Export succeeded but could not deserialize response - is the response specification compliant?",s,o.data)}r({code:A.SUCCESS});return}else if(o.status==="failure"&&o.error){r({code:A.FAILED,error:o.error});return}else o.status==="retryable"?r({code:A.FAILED,error:o.error??new At("Export failed with retryable status")}):r({code:A.FAILED,error:new At("Export failed with unknown error")})},o=>r({code:A.FAILED,error:o})))}forceFlush(){return this._promiseQueue.awaitAll()}async shutdown(){this._diagLogger.debug("shutdown started"),await this.forceFlush(),this._transport.shutdown()}};function Gr(t,e){return new Re(t.transport,t.serializer,wr(),t.promiseHandler,e.timeout)}function ge(t,e,r){return Gr({transport:r,serializer:e,promiseHandler:Vr(t)},{timeout:t.timeoutMillis})}function Br(t){return t>=48&&t<=57?t-48:t>=97&&t<=102?t-87:t-55}function zt(t){let e=new Uint8Array(t.length/2),r=0;for(let n=0;n<t.length;n+=2){let o=Br(t.charCodeAt(n)),s=Br(t.charCodeAt(n+1));e[r++]=o<<4|s}return e}function Fr(t){let e=BigInt(1e9);return BigInt(Math.trunc(t[0]))*e+BigInt(Math.trunc(t[1]))}function Qs(t){let e=Number(BigInt.asUintN(32,t)),r=Number(BigInt.asUintN(32,t>>BigInt(32)));return{low:e,high:r}}function Kr(t){let e=Fr(t);return Qs(e)}function qs(t){return Fr(t).toString()}var Zs=typeof BigInt<"u"?qs:Ee;function Hr(t){return t}function Yr(t){if(t!==void 0)return zt(t)}var ti={encodeHrTime:Kr,encodeSpanContext:zt,encodeOptionalSpanContext:Yr};function kr(t){if(t===void 0)return ti;let e=t.useLongBits??!0,r=t.useHex??!1;return{encodeHrTime:e?Kr:Zs,encodeSpanContext:r?Hr:zt,encodeOptionalSpanContext:r?Hr:Yr}}function jr(t){let e={attributes:lt(t.attributes),droppedAttributesCount:0},r=t.schemaUrl;return r&&r!==""&&(e.schemaUrl=r),e}function Wr(t){return{name:t.name,version:t.version}}function lt(t){return Object.keys(t).map(e=>$r(e,t[e]))}function $r(t,e){return{key:t,value:Xr(e)}}function Xr(t){let e=typeof t;return e==="string"?{stringValue:t}:e==="number"?Number.isInteger(t)?{intValue:t}:{doubleValue:t}:e==="boolean"?{boolValue:t}:t instanceof Uint8Array?{bytesValue:t}:Array.isArray(t)?{arrayValue:{values:t.map(Xr)}}:e==="object"&&t!=null?{kvlistValue:{values:Object.entries(t).map(([r,n])=>$r(r,n))}}:{}}var ei=256,ri=512;function zr(t,e){let r=t&255|ei;return e&&(r|=ri),r}function ni(t,e){let r=t.spanContext(),n=t.status,o=t.parentSpanContext?.spanId?e.encodeSpanContext(t.parentSpanContext?.spanId):void 0;return{traceId:e.encodeSpanContext(r.traceId),spanId:e.encodeSpanContext(r.spanId),parentSpanId:o,traceState:r.traceState?.serialize(),name:t.name,kind:t.kind==null?0:t.kind+1,startTimeUnixNano:e.encodeHrTime(t.startTime),endTimeUnixNano:e.encodeHrTime(t.endTime),attributes:lt(t.attributes),droppedAttributesCount:t.droppedAttributesCount,events:t.events.map(s=>si(s,e)),droppedEventsCount:t.droppedEventsCount,status:{code:n.code,message:n.message},links:t.links.map(s=>oi(s,e)),droppedLinksCount:t.droppedLinksCount,flags:zr(r.traceFlags,t.parentSpanContext?.isRemote)}}function oi(t,e){return{attributes:t.attributes?lt(t.attributes):[],spanId:e.encodeSpanContext(t.context.spanId),traceId:e.encodeSpanContext(t.context.traceId),traceState:t.context.traceState?.serialize(),droppedAttributesCount:t.droppedAttributesCount||0,flags:zr(t.context.traceFlags,t.context.isRemote)}}function si(t,e){return{attributes:t.attributes?lt(t.attributes):[],name:t.name,timeUnixNano:e.encodeHrTime(t.time),droppedAttributesCount:t.droppedAttributesCount||0}}function Jr(t,e){let r=kr(e);return{resourceSpans:ai(t,r)}}function ii(t){let e=new Map;for(let r of t){let n=e.get(r.resource);n||(n=new Map,e.set(r.resource,n));let o=`${r.instrumentationScope.name}@${r.instrumentationScope.version||""}:${r.instrumentationScope.schemaUrl||""}`,s=n.get(o);s||(s=[],n.set(o,s)),s.push(r)}return e}function ai(t,e){let r=ii(t),n=[],o=r.entries(),s=o.next();for(;!s.done;){let[i,a]=s.value,c=[],p=a.values(),E=p.next();for(;!E.done;){let m=E.value;if(m.length>0){let Qt=m.map(ft=>ni(ft,e));c.push({scope:Wr(m[0].instrumentationScope),spans:Qt,schemaUrl:m[0].instrumentationScope.schemaUrl})}E=p.next()}let f=jr(i),g={resource:f,scopeSpans:c,schemaUrl:f.schemaUrl};n.push(g),s=o.next()}return n}var Jt={serializeRequest:t=>{let e=Jr(t,{useHex:!0,useLongBits:!1});return new TextEncoder().encode(JSON.stringify(e))},deserializeResponse:t=>{if(t.length===0)return{};let e=new TextDecoder;return JSON.parse(e.decode(t))}};var he=5,ci=1e3,_i=5e3,pi=1.5,Qr=.2;function Ei(){return Math.random()*(2*Qr)-Qr}var Oe=class{_transport;constructor(e){this._transport=e}retry(e,r,n){return new Promise((o,s)=>{setTimeout(()=>{this._transport.send(e,r).then(o,s)},n)})}async send(e,r){let n=he,o=ci,s=Date.now()+r,i=await this._transport.send(e,r);for(;i.status==="retryable"&&n>0;){n--;let a=Math.max(Math.min(o*(1+Ei()),_i),0);o=o*pi;let c=i.retryInMillis??a,p=s-Date.now();if(c>p)return _.info(`Export retry time ${Math.round(c)}ms exceeds remaining timeout ${Math.round(p)}ms, not retrying further.`),i;_.verbose(`Scheduling export retry in ${Math.round(c)}ms`),i=await this.retry(e,p,c)}return i.status==="success"?_.verbose(`Export succeeded after ${he-n} retry attempts.`):i.status==="retryable"?_.info(`Export failed after maximum retry attempts (${he}).`):_.info(`Export failed with non-retryable error: ${i.error}`),i}shutdown(){return this._transport.shutdown()}};function xe(t){return new Oe(t.transport)}var Pe=class{_params;constructor(e){this._params=e}async send(e){let r=(await this._params.headers())["Content-Type"];return new Promise(n=>{navigator.sendBeacon(this._params.url,new Blob([e],{type:r}))?(_.debug("SendBeacon success"),n({status:"success"})):n({status:"failure",error:new Error("SendBeacon failed")})})}shutdown(){}};function qr(t){return new Pe(t)}function Zr(t){return t===429||t===502||t===503||t===504}function tn(t){if(t==null)return;let e=Number.parseInt(t,10);if(Number.isInteger(e))return e>0?e*1e3:-1;let r=new Date(t).getTime()-Date.now();return r>=0?r:0}var Le=class{_parameters;constructor(e){this._parameters=e}async send(e,r){let n=new AbortController,o=setTimeout(()=>n.abort(),r);try{let s=!!globalThis.location,i=new URL(this._parameters.url),a=await fetch(i.href,{method:"POST",headers:await this._parameters.headers(),body:e,signal:n.signal,keepalive:s,mode:s?globalThis.location?.origin===i.origin?"same-origin":"cors":"no-cors"});if(a.status>=200&&a.status<=299)return _.debug("response success"),{status:"success"};if(Zr(a.status)){let c=a.headers.get("Retry-After");return{status:"retryable",retryInMillis:tn(c)}}return{status:"failure",error:new Error("Fetch request failed with non-retryable status")}}catch(s){return ui(s)?{status:"retryable",error:new Error("Fetch request encountered a network error",{cause:s})}:{status:"failure",error:new Error("Fetch request errored",{cause:s})}}finally{clearTimeout(o)}}shutdown(){}};function en(t){return new Le(t)}function ui(t){return t instanceof TypeError&&!t.cause}function rn(t,e){return ge(t,e,xe({transport:en(t)}))}function nn(t,e){return ge(t,e,xe({transport:qr({url:t.url,headers:t.headers})}))}function on(t){let e={};return Object.entries(t??{}).forEach(([r,n])=>{typeof n<"u"?e[r]=String(n):_.warn(`Header "${r}" has invalid value (${n}) and will be ignored`)}),e}function Ti(t,e,r){return async()=>{let n={...await r()},o={};return e!=null&&Object.assign(o,await e()),t!=null&&Object.assign(o,on(await t())),Object.assign(o,n)}}function Si(t){if(t!=null)try{let e=globalThis.location?.href;return new URL(t,e).href}catch{throw new Error(`Configuration: Could not parse user-provided export URL: '${t}'`)}}function sn(t,e,r){return{...br(t,e,r),headers:Ti(t.headers,e.headers,r.headers),url:Si(t.url)??e.url??r.url}}function an(t,e){return{...vr(),headers:async()=>t,url:"http://localhost:4318/"+e}}function cn(t){return typeof t.headers=="function"?t.headers:yr(t.headers)}function _n(t,e,r){return sn({url:t.url,timeoutMillis:t.timeoutMillis,headers:cn(t),concurrencyLimit:t.concurrencyLimit},{},an(r,e))}function Ne(t,e,r,n){let o=Ai(t.headers),s=_n(t,r,n);return o(s,e)}function Ai(t){return!t&&typeof navigator.sendBeacon=="function"?nn:rn}var W=class extends St{constructor(e={}){super(Ne(e,Jt,"v1/traces",{"Content-Type":"application/json"}))}};window.otel={WebTracerProvider:Tt,SimpleSpanProcessor:ut,ConsoleSpanExporter:Et,OTLPTraceExporter:W,resourceFromAttributes:Ft,SemanticResourceAttributes:ir};})();
